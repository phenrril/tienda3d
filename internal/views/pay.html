{{define "pay.html"}}
{{template "layout_start" .}}
<section style="max-width:760px;margin:30px auto 0;display:flex;flex-direction:column;gap:18px">
  <h1 style="margin:0;font-size:28px">Estado del pago</h1>
  {{if .StatusMsg}}
    {{if and (not .Success) (eq .Order.PaymentMethod "efectivo")}}
      <div style="padding:12px 14px;border-radius:12px;background:#78350f;border:1px solid #f59e0b;color:#fff;font-weight:600;display:flex;flex-direction:column;gap:12px">
        <div style="display:flex;align-items:center;gap:10px">
          <span style="font-size:24px">‚ö†Ô∏è</span>
          <strong>Pendiente de pago</strong>
        </div>
        <p style="margin:0;font-size:14px;line-height:1.5">
          Comunicate con nosotros por WhatsApp para coordinar el pago en efectivo y el retiro de tu pedido.
        </p>
        <a href="https://wa.me/{{.WhatsAppPhone}}?text=Hola%2C%20quiero%20coordinar%20el%20pago%20de%20mi%20orden%20{{.Order.ID}}" target="_blank" rel="noopener" style="display:inline-flex;align-items:center;gap:8px;padding:10px 16px;background:#25D366;color:#fff;border-radius:8px;text-decoration:none;font-weight:600;font-size:14px;width:fit-content">
          <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor"><path d="M12.04 2c-5.52 0-10 4.46-10 9.97 0 1.76.46 3.48 1.34 5.01L2 22l5.2-1.36a9.96 9.96 0 0 0 4.84 1.23h.01c5.52 0 10-4.46 10-9.97 0-2.67-1.05-5.18-2.95-7.06A9.93 9.93 0 0 0 12.04 2Z"/></svg>
          Contactar por WhatsApp
        </a>
      </div>
    {{else}}
      <div style="padding:12px 14px;border-radius:12px;background:{{if .Success}}#064e3b{{else}}#3f1d1d{{end}};border:1px solid {{if .Success}}#10b981{{else}}#ef4444{{end}};color:#fff;font-weight:600">{{.StatusMsg}}</div>
    {{end}}
  {{end}}
  {{if .IsTransferenciaPending}}
  <div style="background:linear-gradient(135deg, #1a2b3e 0%, #0f1b2d 100%);border:2px solid #10b981;border-radius:14px;padding:24px;display:flex;flex-direction:column;gap:16px;box-shadow:0 4px 20px rgba(16,185,129,0.2)">
    <h2 style="margin:0;font-size:24px;color:#fff">üìã Instrucciones para Transferencia</h2>
    
    <div style="padding:20px;background:#0f1b2d;border-radius:12px;border:2px solid #223140;text-align:center">
      <div style="margin-bottom:16px;font-size:14px;color:#94a3b8;text-transform:uppercase;letter-spacing:0.5px">Transfiere a este alias:</div>
      <div style="font-family:'Courier New', monospace;font-size:32px;color:#10b981;font-weight:bold;letter-spacing:2px;padding:16px 20px;background:#0a1420;border-radius:8px;border:2px solid #10b981;display:inline-block;box-shadow:0 0 20px rgba(16,185,129,0.3)">
        chroma3d
      </div>
    </div>
    
    <div style="padding:16px;background:rgba(16,185,129,0.1);border-radius:10px;border:1px solid #10b981">
      <div style="display:flex;align-items:center;gap:12px;margin-bottom:8px">
        <span style="font-size:24px">üí∞</span>
        <div style="flex:1">
          <div style="font-size:12px;color:#94a3b8;text-transform:uppercase">Monto a transferir</div>
          <div style="font-size:28px;color:#fff;font-weight:bold">${{printf "%.2f" .Order.Total}}</div>
        </div>
      </div>
    </div>
    
    <div style="padding:20px;background:rgba(16,185,129,0.1);border-radius:12px;border:2px solid #10b981">
      <div style="margin-bottom:12px;font-size:18px;color:#fff;font-weight:600">
        ‚ö†Ô∏è IMPORTANTE: Env√≠a el comprobante
      </div>
      <p style="margin:0 0 16px;color:#cbd5e1;line-height:1.6;font-size:15px">
        Una vez realizada la transferencia, env√≠a el comprobante de pago por WhatsApp para que podamos confirmar la transferencia e iniciar la producci√≥n de tu pedido.
      </p>
      <a href="https://wa.me/{{.WhatsAppPhone}}?text=Comprobante%20de%20transferencia%20para%20la%20orden%20{{.Order.ID}}" target="_blank" rel="noopener noreferrer" style="display:block;padding:16px 24px;background:#25D366;color:#fff;border-radius:10px;text-decoration:none;font-weight:700;font-size:16px;text-align:center;box-shadow:0 4px 12px rgba(37,211,102,0.3);transition:transform 0.2s">
        üì≤ Enviar comprobante por WhatsApp
      </a>
    </div>
  </div>
  {{end}}
  <div style="background:var(--panel);border:1px solid var(--border);border-radius:14px;padding:18px;display:flex;flex-direction:column;gap:10px">
    <div><strong>Orden:</strong> {{.Order.ID}}</div>
    <div><strong>Nombre:</strong> {{.Order.Name}}</div>
    <div><strong>Email:</strong> {{.Order.Email}}</div>
    <div><strong>Tel√©fono:</strong> {{.Order.Phone}}</div>
    <div><strong>DNI:</strong> {{.Order.DNI}}</div>
    <div><strong>M√©todo:</strong> {{if eq .Order.ShippingMethod "envio"}}Env√≠o{{else if eq .Order.ShippingMethod "cadete"}}Cadete (Rosario){{else}}Retiro{{end}}</div>
    {{if or (eq .Order.ShippingMethod "envio") (eq .Order.ShippingMethod "cadete") }}
      <div><strong>Direcci√≥n:</strong> {{.Order.Address}} {{if .Order.PostalCode}}({{.Order.PostalCode}} ‚Äì {{.Order.Province}}){{end}}</div>
      <div><strong>Costo env√≠o:</strong> ${{printf "%.2f" .Order.ShippingCost}}</div>
    {{end}}
    <div><strong>Total:</strong> ${{printf "%.2f" .Order.Total}}</div>
    <div style="margin-top:6px"><strong>Items:</strong></div>
    <ul style="margin:0;padding-left:18px;display:flex;flex-direction:column;gap:4px">
      {{range .Order.Items}}
        <li>{{.Title}} x{{.Qty}} ‚Äî ${{printf "%.2f" .UnitPrice}} {{if .Color}}<span style="display:inline-block;width:14px;height:14px;border-radius:4px;border:1px solid #000;vertical-align:middle;background:{{.Color}}"></span>{{end}}</li>
      {{end}}
    </ul>
  </div>
  <a href="/products" class="btn-secondary" style="text-decoration:none;display:inline-block;width:max-content">Volver al cat√°logo</a>
</section>
{{template "layout_end" .}}
{{end}}
